# Example graph demonstrating type: map for parallel processing
# Generates a list of ideas then expands each in parallel

name: map-demo
version: "1.0"
description: "Demonstrates parallel fan-out with type: map"
prompts_relative: true
prompts_dir: prompts

defaults:
  provider: mistral

nodes:
  generate:
    prompt: generate_ideas
    state_key: ideas
    variables:
      topic: "{state.topic}"

  expand:
    type: map
    over: "{state.ideas.ideas}"
    as: idea
    node:
      prompt: expand_idea
      state_key: expansion
      variables:
        idea: "{state.idea}"
    collect: expansions

  summarize:
    prompt: summarize_ideas
    state_key: summary
    variables:
      expansions: "{state.expansions}"

edges:
  - from: START
    to: generate
  - from: generate
    to: expand
  - from: expand
    to: summarize
  - from: summarize
    to: END
